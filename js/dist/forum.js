module.exports=function(t){var e={};function r(o){if(e[o])return e[o].exports;var s=e[o]={i:o,l:!1,exports:{}};return t[o].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=t,r.c=e,r.d=function(t,e,o){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:o})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(r.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)r.d(o,s,function(e){return t[e]}.bind(null,s));return o},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=19)}([function(t,e){t.exports=flarum.core.compat.app},function(t,e,r){"use strict";function o(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}r.d(e,"a",(function(){return o}))},function(t,e){t.exports=flarum.core.compat.extend},function(t,e){t.exports=flarum.core.compat["components/IndexPage"]},function(t,e){t.exports=flarum.core.compat["components/LinkButton"]},function(t,e){t.exports=flarum.core.compat["components/Button"]},function(t,e){t.exports=flarum.core.compat.Component},function(t,e){t.exports=flarum.core.compat["helpers/listItems"]},function(t,e){t.exports=flarum.core.compat["utils/ItemList"]},function(t,e){t.exports=flarum.core.compat["components/UsersSearchSource"]},function(t,e){t.exports=flarum.core.compat["components/Page"]},function(t,e){t.exports=flarum.core.compat["components/Select"]},function(t,e){t.exports=flarum.core.compat["components/SelectDropdown"]},function(t,e){t.exports=flarum.core.compat["components/LoadingIndicator"]},function(t,e){t.exports=flarum.core.compat["components/Placeholder"]},function(t,e){t.exports=flarum.core.compat["components/UserCard"]},,,,function(t,e,r){"use strict";r.r(e),r.d(e,"UserDirectoryPage",(function(){return A})),r.d(e,"UserDirectoryList",(function(){return M})),r.d(e,"UserDirectoryListItem",(function(){return C})),r.d(e,"UserDirectoryState",(function(){return q}));var o=r(2),s=r(0),n=r.n(s),a=r(9),i=r.n(a),u=r(4),c=r.n(u),f=r(3),p=r.n(f),l=r(1),d=r(10),h=r.n(d),y=r(8),v=r.n(y),g=r(7),b=r.n(g),x=r(11),_=r.n(x),P=r(5),N=r.n(P),I=r(12),w=r.n(I),j=r(6),O=r.n(j),S=r(13),U=r.n(S),k=r(14),L=r.n(k),D=r(15),R=r.n(D),C=function(t){function e(){return t.apply(this,arguments)||this}return Object(l.a)(e,t),e.prototype.view=function(){var t=this.attrs.user;return m("div",{className:"User"},R.a.component({user:t,className:"UserCard--directory",controlsButtonClassName:"Button Button--icon Button--flat"}))},e}(O.a),M=function(t){function e(){return t.apply(this,arguments)||this}return Object(l.a)(e,t),e.prototype.view=function(){var t,e=this.attrs.state,r=e.getParams();if(e.isLoading()?t=U.a.component():e.moreResults&&(t=N.a.component({className:"Button",onclick:e.loadMore.bind(e)},n.a.translator.trans("fof-user-directory.forum.page.load_more_button"))),e.empty()){var o=n.a.translator.trans("fof-user-directory.forum.page.empty_text");return m("div",{className:"DiscussionList"},L.a.component({text:o}))}return m("div",{className:"UserDirectoryList"+(e.isSearchResults()?" UserDirectoryList--searchResults":"")},m("ul",{className:"UserDirectoryList-users"},e.users.map((function(t){return m("li",{key:t.id(),"data-id":t.id()},C.component({user:t,params:r}))}))),m("div",{className:"UserDirectoryList-loadMore"},t))},e}(O.a),q=function(){function t(t,e){void 0===t&&(t={}),void 0===e&&(e=window.app),this.params=t,this.app=e,this.users=[],this.moreResults=!1,this.loading=!1}var e=t.prototype;return e.requestParams=function(){var t={include:[],filter:{}};return t.sort=this.sortMap()[this.params.sort],this.params.q&&(t.filter.q=this.params.q),t},e.sortMap=function(){var t={default:"",username_az:"username",username_za:"-username",newest:"-joinedAt",oldest:"joinedAt",seen_recent:"-lastSeenAt",seen_oldest:"lastSeenAt",most_discussions:"-discussionCount",least_discussions:"discussionCount"};return t},e.getParams=function(){return this.params},e.clear=function(){this.users=[],m.redraw()},e.refreshParams=function(t){var e=this;this.hasUsers()&&!Object.keys(t).some((function(r){return e.getParams()[r]!==t[r]}))||(this.params=t,this.refresh())},e.refresh=function(){var t=this;return this.loading=!0,this.clear(),this.loadResults().then((function(e){t.parseResults(e)}),(function(){t.loading=!1,m.redraw()}))},e.loadResults=function(t){var e=this.app.preloadedApiDocument();if(e)return Promise.resolve(e);var r=this.requestParams();return r.page={offset:t},r.include=r.include.join(","),this.app.store.find("users",r)},e.loadMore=function(){this.loading=!0,this.loadResults(this.users.length).then(this.parseResults.bind(this))},e.parseResults=function(t){var e;return(e=this.users).push.apply(e,t),this.loading=!1,this.moreResults=!!t.payload.links&&!!t.payload.links.next,m.redraw(),t},e.hasUsers=function(){return this.users.length>0},e.isLoading=function(){return this.loading},e.isSearchResults=function(){return!!this.params.q},e.empty=function(){return!this.hasUsers()&&!this.isLoading()},t}(),A=function(t){function e(){return t.apply(this,arguments)||this}Object(l.a)(e,t);var r=e.prototype;return r.oninit=function(e){t.prototype.oninit.call(this,e),this.state=new q({}),this.state.refreshParams(n.a.search.params()),this.bodyClass="User--directory"},r.view=function(){return m("div",{className:"IndexPage"},p.a.prototype.hero(),m("div",{className:"container"},m("div",{className:"sideNavContainer"},m("nav",{className:"IndexPage-nav sideNav"},m("ul",null,b()(this.sidebarItems().toArray()))),m("div",{className:"IndexPage-results sideNavOffset"},m("div",{className:"IndexPage-toolbar"},m("ul",{className:"IndexPage-toolbar-view"},b()(this.viewItems().toArray())),m("ul",{className:"IndexPage-toolbar-action"},b()(this.actionItems().toArray()))),m(M,{state:this.state})))))},r.sidebarItems=function(){var t=p.a.prototype.sidebarItems();return t.replace("nav",w.a.component({buttonClassName:"Button",className:"App-titleControl"},this.navItems().toArray())),t},r.navItems=function(){var t=p.a.prototype.navItems(),e=this.stickyParams();return t.add("fof-user-directory",c.a.component({href:n.a.route("fof_user_directory",e),icon:"far fa-address-book"},n.a.translator.trans("fof-user-directory.forum.page.nav")),85),t},r.viewItems=function(){var t=new v.a,e=this.state.sortMap(),r={};for(var o in e)r[o]=n.a.translator.trans("fof-user-directory.forum.page.sort."+o);return t.add("sort",_.a.component({options:r,value:this.params().sort||Object.keys(e)[0],onchange:this.changeSort.bind(this)})),t},r.actionItems=function(){var t=this,e=new v.a;return e.add("refresh",N.a.component({title:n.a.translator.trans("fof-user-directory.forum.page.refresh_tooltip"),icon:"fas fa-sync",className:"Button Button--icon",onclick:function(){t.state.refresh(),n.a.session.user&&(n.a.store.find("users",n.a.session.user.id()),m.redraw())}})),e},r.changeSort=function(t){var e=this.params();t===Object.keys(this.state.sortMap())[0]?delete e.sort:e.sort=t,m.route.set(n.a.route(this.attrs.routeName,e))},r.stickyParams=function(){return{sort:m.route.param("sort"),q:m.route.param("q")}},r.params=function(){return this.stickyParams()},e}(h.a);n.a.initializers.add("fof-user-directory",(function(t){t.routes.fof_user_directory={path:"/users",component:A},Object(o.extend)(i.a.prototype,"view",(function(e,r){e&&(r=r.toLowerCase(),e.splice(1,0,m("li",c.a.component({href:t.route("fof_user_directory",{q:r}),icon:"fas fa-search"},t.translator.trans("fof-user-directory.forum.search.users_heading",{query:r})))))})),Object(o.extend)(p.a.prototype,"navItems",(function(e){t.forum.attribute("canSeeUserDirectoryLink")&&e.add("fof-user-directory",c.a.component({href:t.route("fof_user_directory"),icon:"far fa-address-book"},t.translator.trans("fof-user-directory.forum.page.nav")),85)}))}))}]);
//# sourceMappingURL=forum.js.map
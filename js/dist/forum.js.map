{"version":3,"sources":["webpack://@fof/user-directory/webpack/bootstrap","webpack://@fof/user-directory/./forum.js","webpack://@fof/user-directory/./node_modules/@babel/runtime/helpers/esm/extends.js","webpack://@fof/user-directory/./node_modules/@babel/runtime/helpers/esm/inheritsLoose.js","webpack://@fof/user-directory/./src/common/utils/SortMap.js","webpack://@fof/user-directory/./src/forum/components/CheckableButton.js","webpack://@fof/user-directory/./src/forum/components/SearchField.js","webpack://@fof/user-directory/./src/forum/components/UserDirectoryList.js","webpack://@fof/user-directory/./src/forum/components/UserDirectoryListItem.js","webpack://@fof/user-directory/./src/forum/components/UserDirectoryPage.js","webpack://@fof/user-directory/./src/forum/index.js","webpack://@fof/user-directory/./src/forum/states/UserDirectoryState.js","webpack://@fof/user-directory/external \"flarum.core.compat['common/Component']\"","webpack://@fof/user-directory/external \"flarum.core.compat['common/app']\"","webpack://@fof/user-directory/external \"flarum.core.compat['common/components/Button']\"","webpack://@fof/user-directory/external \"flarum.core.compat['common/components/Dropdown']\"","webpack://@fof/user-directory/external \"flarum.core.compat['common/components/IndexPage']\"","webpack://@fof/user-directory/external \"flarum.core.compat['common/components/LinkButton']\"","webpack://@fof/user-directory/external \"flarum.core.compat['common/components/LoadingIndicator']\"","webpack://@fof/user-directory/external \"flarum.core.compat['common/components/Page']\"","webpack://@fof/user-directory/external \"flarum.core.compat['common/components/Placeholder']\"","webpack://@fof/user-directory/external \"flarum.core.compat['common/components/Select']\"","webpack://@fof/user-directory/external \"flarum.core.compat['common/components/SelectDropdown']\"","webpack://@fof/user-directory/external \"flarum.core.compat['common/components/Separator']\"","webpack://@fof/user-directory/external \"flarum.core.compat['common/components/UserCard']\"","webpack://@fof/user-directory/external \"flarum.core.compat['common/components/UsersSearchSource']\"","webpack://@fof/user-directory/external \"flarum.core.compat['common/extend']\"","webpack://@fof/user-directory/external \"flarum.core.compat['common/helpers/icon']\"","webpack://@fof/user-directory/external \"flarum.core.compat['common/helpers/listItems']\"","webpack://@fof/user-directory/external \"flarum.core.compat['common/utils/ItemList']\"","webpack://@fof/user-directory/external \"flarum.core.compat['common/utils/withAttr']\""],"names":["SortMap","sortMap","username_az","username_za","newest","oldest","most_discussions","least_discussions","CheckableButton","getButtonContent","children","prev","attrs","checked","push","icon","className","Button","SearchField","oninit","vnode","view","app","translator","trans","filter","withAttr","value","performNewSearch","state","refreshParams","getParams","qBuilder","Component","UserDirectoryList","params","loading","isLoading","LoadingIndicator","component","moreResults","onclick","loadMore","bind","empty","text","Placeholder","isSearchResults","users","map","user","id","UserDirectoryListItem","UserCard","controlsButtonClassName","UserDirectoryPage","UserDirectoryState","search","bodyClass","idSegments","q","Array","from","matchAll","forEach","match","enabledGroupFilters","join","split","enabledSpecialGroupFilters","history","IndexPage","prototype","hero","listItems","sidebarItems","toArray","viewItems","actionItems","items","replace","SelectDropdown","buttonClassName","navItems","stickyParams","add","LinkButton","href","route","ItemList","sortOptions","i","Select","options","sort","forum","attribute","onchange","changeParams","Dropdown","caretIcon","label","groupItems","store","all","group","namePlural","includes","e","initializers","has","Separator","title","refresh","session","find","m","redraw","moreQ","length","groups","trim","param","Page","routes","fof_user_directory","path","extend","UsersSearchSource","query","toLowerCase","splice","window","requestParams","include","sortKey","clear","newParams","hasUsers","Object","keys","some","key","values","loadResults","then","results","parseResults","offset","preloadedUsers","preloadedApiDocument","Promise","resolve","page","payload","links","next"],"mappings":";;QAAA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;;AClFA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAe;AACf;AACA,mBAAmB,sBAAsB;AACzC;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,C;;;;;;;;;;;;AChBA;AAAA;AAAe;AACf;AACA;AACA;AACA,C;;;;;;;;;;;;ACJA;AAAA;AAAA;AACA;AACA;AACA;IACqBA,O;;;;;SACjBC,O,GAAA,mBAAU;AACN,WAAO;AACHC,iBAAW,EAAE,UADV;AAEHC,iBAAW,EAAE,WAFV;AAGHC,YAAM,EAAE,WAHL;AAIHC,YAAM,EAAE,UAJL;AAKHC,sBAAgB,EAAE,kBALf;AAMHC,uBAAiB,EAAE;AANhB,KAAP;AAQH,G;;;;;;;;;;;;;;;;;;;;;;;;;ACdL;AACA;;IAEqBC,e;;;;;;;;;AACjB;AACJ;AACA;AACA;AACA;AACA;SACIC,gB,GAAA,0BAAiBC,QAAjB,EAA2B;AACvB,QAAMC,IAAI,qBAASF,gBAAT,YAA0BC,QAA1B,CAAV;;AAEA,QAAI,KAAKE,KAAL,CAAWC,OAAf,EAAwBF,IAAI,CAACG,IAAL,CAAUC,iEAAI,CAAC,cAAD,EAAiB;AAAEC,eAAS,EAAE;AAAb,KAAjB,CAAd;AAExB,WAAOL,IAAP;AACH,G;;;EAbwCM,sE;;;;;;;;;;;;;;;;;;;;;;;;;;ACH7C;AACA;AACA;;IAEqBC,W;;;;;;;;;SACjBC,M,GAAA,gBAAOC,KAAP,EAAc;AACV,yBAAMD,MAAN,YAAaC,KAAb;AACH,G;;SAEDC,I,GAAA,gBAAO;AAAA;;AACH,WACI;AAAK,eAAS,EAAC;AAAf,OACI;AACI,eAAS,EAAC,aADd;AAEI,iBAAW,EAAEC,wDAAG,CAACC,UAAJ,CAAeC,KAAf,CAAqB,mDAArB,CAFjB;AAGI,WAAK,EAAE,KAAKC,MAHhB;AAII,aAAO,EAAEC,mEAAQ,CAAC,OAAD,EAAU,UAACC,KAAD,EAAW;AAClC,aAAI,CAACF,MAAL,GAAcE,KAAd;;AACA,aAAI,CAACC,gBAAL;AACH,OAHgB;AAJrB,MADJ,CADJ;AAaH,G;;SAEDA,gB,GAAA,4BAAmB;AACf,SAAKhB,KAAL,CAAWiB,KAAX,CAAiBC,aAAjB,wFAAoC,KAAKlB,KAAL,CAAWiB,KAAX,CAAiBE,SAAjB,EAApC;AAAkEC,cAAQ,EAAE;AAAEP,cAAM,EAAE,KAAKA;AAAf;AAA5E;AACH,G;;;EAvBoCQ,8D;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACJzC;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;;IACqBC,iB;;;;;;;;;SACjBb,I,GAAA,gBAAO;AAAA,QACKQ,KADL,GACe,KAAKjB,KADpB,CACKiB,KADL;AAGH,QAAMM,MAAM,GAAGN,KAAK,CAACE,SAAN,EAAf;AACA,QAAIK,OAAJ;;AAEA,QAAIP,KAAK,CAACQ,SAAN,EAAJ,EAAuB;AACnBD,aAAO,GAAGE,gFAAgB,CAACC,SAAjB,EAAV;AACH,KAFD,MAEO,IAAIV,KAAK,CAACW,WAAV,EAAuB;AAC1BJ,aAAO,GAAGnB,sEAAM,CAACsB,SAAP,CACN;AACIvB,iBAAS,EAAE,QADf;AAEIyB,eAAO,EAAEZ,KAAK,CAACa,QAAN,CAAeC,IAAf,CAAoBd,KAApB;AAFb,OADM,EAKNP,wDAAG,CAACC,UAAJ,CAAeC,KAAf,CAAqB,gDAArB,CALM,CAAV;AAOH;;AAED,QAAIK,KAAK,CAACe,KAAN,EAAJ,EAAmB;AACf,UAAMC,IAAI,GAAGvB,wDAAG,CAACC,UAAJ,CAAeC,KAAf,CAAqB,0CAArB,CAAb;AACA,aAAO;AAAK,iBAAS,EAAC;AAAf,SAAiCsB,2EAAW,CAACP,SAAZ,CAAsB;AAAEM,YAAI,EAAJA;AAAF,OAAtB,CAAjC,CAAP;AACH;;AAED,WACI;AAAK,eAAS,EAAE,uBAAuBhB,KAAK,CAACkB,eAAN,KAA0B,mCAA1B,GAAgE,EAAvF;AAAhB,OACI;AAAI,eAAS,EAAC;AAAd,OACKlB,KAAK,CAACmB,KAAN,CAAYC,GAAZ,CAAgB,UAACC,IAAD,EAAU;AACvB,aACI;AAAI,WAAG,EAAEA,IAAI,CAACC,EAAL,EAAT;AAAoB,mBAASD,IAAI,CAACC,EAAL;AAA7B,SACKC,8DAAqB,CAACb,SAAtB,CAAgC;AAAEW,YAAI,EAAJA,IAAF;AAAQf,cAAM,EAANA;AAAR,OAAhC,CADL,CADJ;AAKH,KANA,CADL,CADJ,EAUI;AAAK,eAAS,EAAC;AAAf,OAA6CC,OAA7C,CAVJ,CADJ;AAcH,G;;;EAtC0CH,8D;;;;;;;;;;;;;;;;;;;;;;ACV/C;AACA;;IAEqBmB,qB;;;;;;;;;SACjB/B,I,GAAA,gBAAO;AAAA,QACK6B,IADL,GACc,KAAKtC,KADnB,CACKsC,IADL;AAGH,WACI;AAAK,eAAS,EAAC;AAAf,OACKG,wEAAQ,CAACd,SAAT,CAAmB;AAChBW,UAAI,EAAJA,IADgB;AAEhBlC,eAAS,EAAE,qBAFK;AAGhBsC,6BAAuB,EAAE;AAHT,KAAnB,CADL,CADJ;AASH,G;;;EAb8CrB,8D;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACHnD;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;;IACqBsB,iB;;;;;;;;;SACjBpC,M,GAAA,gBAAOC,KAAP,EAAc;AACV,oBAAMD,MAAN,YAAaC,KAAb;;AAEA,SAAKS,KAAL,GAAa,IAAI2B,mEAAJ,CAAuB,EAAvB,CAAb;AACA,SAAK3B,KAAL,CAAWC,aAAX,CAAyBR,wDAAG,CAACmC,MAAJ,CAAWtB,MAAX,EAAzB;AAEA,SAAKuB,SAAL,GAAiB,iBAAjB;AAEA,QAAIC,UAAU,GAAG,EAAjB;;AACA,QAAI,KAAKxB,MAAL,GAAcyB,CAAlB,EAAqB;AACjBC,WAAK,CAACC,IAAN,CAAW,KAAK3B,MAAL,GAAcyB,CAAd,CAAgBG,QAAhB,CAAyB,iBAAzB,CAAX,EAAwDC,OAAxD,CAAgE,UAACC,KAAD,EAAW;AACvEN,kBAAU,CAAC7C,IAAX,CAAgBmD,KAAK,CAAC,CAAD,CAArB;AACH,OAFD;AAGH;;AACD,SAAKC,mBAAL,GAA2BP,UAAU,CAChCQ,IADsB,CACjB,GADiB,EAEtBC,KAFsB,CAEhB,GAFgB,EAGtB3C,MAHsB,CAGf,UAAC0B,EAAD;AAAA,aAAQA,EAAR;AAAA,KAHe,CAA3B;AAKA,SAAKkB,0BAAL,GAAkC,EAAlC;AAEA/C,4DAAG,CAACgD,OAAJ,CAAYxD,IAAZ,CAAiB,OAAjB,EAA0BQ,wDAAG,CAACC,UAAJ,CAAeC,KAAf,CAAqB,gEAArB,CAA1B;AACH,G;;SAEDH,I,GAAA,gBAAO;AACH,WACI;AAAK,eAAS,EAAC;AAAf,OACKkD,yEAAS,CAACC,SAAV,CAAoBC,IAApB,EADL,EAEI;AAAK,eAAS,EAAC;AAAf,OACI;AAAK,eAAS,EAAC;AAAf,OACI;AAAK,eAAS,EAAC;AAAf,OACI,cAAKC,sEAAS,CAAC,KAAKC,YAAL,GAAoBC,OAApB,EAAD,CAAd,CADJ,CADJ,EAII;AAAK,eAAS,EAAC;AAAf,OACI;AAAK,eAAS,EAAC;AAAf,OACI;AAAI,eAAS,EAAC;AAAd,OAAwCF,sEAAS,CAAC,KAAKG,SAAL,GAAiBD,OAAjB,EAAD,CAAjD,CADJ,EAEI;AAAI,eAAS,EAAC;AAAd,OAA0CF,sEAAS,CAAC,KAAKI,WAAL,GAAmBF,OAAnB,EAAD,CAAnD,CAFJ,CADJ,EAKI,EAAC,2DAAD;AAAmB,WAAK,EAAE,KAAK/C;AAA/B,MALJ,CAJJ,CADJ,CAFJ,CADJ;AAmBH;AAED;AACJ;AACA;AACA;AACA;AACA;;;SACI8C,Y,GAAA,wBAAe;AACX,QAAMI,KAAK,GAAGR,yEAAS,CAACC,SAAV,CAAoBG,YAApB,EAAd;AAEAI,SAAK,CAACC,OAAN,CACI,KADJ,EAEIC,8EAAc,CAAC1C,SAAf,CACI;AACI2C,qBAAe,EAAE,QADrB;AAEIlE,eAAS,EAAE;AAFf,KADJ,EAKI,KAAKmE,QAAL,GAAgBP,OAAhB,EALJ,CAFJ;AAWA,WAAOG,KAAP;AACH;AAED;AACJ;AACA;AACA;AACA;AACA;;;SACII,Q,GAAA,oBAAW;AACP,QAAMJ,KAAK,GAAGR,yEAAS,CAACC,SAAV,CAAoBW,QAApB,EAAd;AACA,QAAMhD,MAAM,GAAG,KAAKiD,YAAL,EAAf;AAEAL,SAAK,CAACM,GAAN,CACI,oBADJ,EAEIC,0EAAU,CAAC/C,SAAX,CACI;AACIgD,UAAI,EAAEjE,wDAAG,CAACkE,KAAJ,CAAU,oBAAV,EAAgCrD,MAAhC,CADV;AAEIpB,UAAI,EAAE;AAFV,KADJ,EAKIO,wDAAG,CAACC,UAAJ,CAAeC,KAAf,CAAqB,mCAArB,CALJ,CAFJ,EASI,EATJ;AAYA,WAAOuD,KAAP;AACH,G;;SAEDF,S,GAAA,qBAAY;AACR,QAAME,KAAK,GAAG,IAAIU,mEAAJ,EAAd;AACA,QAAMxF,OAAO,GAAG,KAAK4B,KAAL,CAAW5B,OAAX,EAAhB;AAEA,QAAMyF,WAAW,GAAG,EAApB;;AACA,SAAK,IAAMC,CAAX,IAAgB1F,OAAhB,EAAyB;AACrByF,iBAAW,CAACC,CAAD,CAAX,GAAiBrE,wDAAG,CAACC,UAAJ,CAAeC,KAAf,CAAqB,iCAAiCmE,CAAtD,CAAjB;AACH;;AAEDZ,SAAK,CAACM,GAAN,CACI,MADJ,EAEIO,sEAAM,CAACrD,SAAP,CAAiB;AACbsD,aAAO,EAAEH,WADI;AAEb/D,WAAK,EAAE,KAAKQ,MAAL,GAAc2D,IAAd,IAAsBxE,wDAAG,CAACyE,KAAJ,CAAUC,SAAV,CAAoB,0BAApB,CAFhB;AAGbC,cAAQ,EAAE,KAAKC,YAAL,CAAkBvD,IAAlB,CAAuB,IAAvB;AAHG,KAAjB,CAFJ;AASAoC,SAAK,CAACM,GAAN,CACI,cADJ,EAEIc,yEAAQ,CAAC5D,SAAT,CACI;AACI6D,eAAS,EAAE,eADf;AAEIC,WAAK,EAAE/E,wDAAG,CAACC,UAAJ,CAAeC,KAAf,CAAqB,6CAArB,CAFX;AAGI0D,qBAAe,EAAE,aAHrB;AAIIlE,eAAS,EAAE;AAJf,KADJ,EAOI,KAAKsF,UAAL,GAAkB1B,OAAlB,EAPJ,CAFJ;AAaAG,SAAK,CAACM,GAAN,CACI,QADJ,EAEInE,qDAAW,CAACqB,SAAZ,CAAsB;AAClBV,WAAK,EAAE,KAAKA;AADM,KAAtB,CAFJ;AAOA,WAAOkD,KAAP;AACH,G;;SAEDuB,U,GAAA,sBAAa;AAAA;;AACT,QAAMvB,KAAK,GAAG,IAAIU,mEAAJ,EAAd;AAEAnE,4DAAG,CAACiF,KAAJ,CACKC,GADL,CACS,QADT,EAEK/E,MAFL,CAEY,UAACgF,KAAD;AAAA,aAAWA,KAAK,CAACtD,EAAN,OAAe,GAAf,IAAsBsD,KAAK,CAACtD,EAAN,OAAe,GAAhD;AAAA,KAFZ,EAGKa,OAHL,CAGa,UAACyC,KAAD,EAAW;AAChB1B,WAAK,CAACM,GAAN,CACIoB,KAAK,CAACC,UAAN,EADJ,EAEIlG,yDAAe,CAAC+B,SAAhB,CACI;AACIvB,iBAAS,EAAE,mBADf;AAEID,YAAI,EAAE0F,KAAK,CAAC1F,IAAN,EAFV;AAGIF,eAAO,EAAE,KAAI,CAACqD,mBAAL,CAAyByC,QAAzB,CAAkCF,KAAK,CAACtD,EAAN,EAAlC,CAHb;AAIIV,eAAO,EAAE,mBAAM;AACX,cAAMU,EAAE,GAAGsD,KAAK,CAACtD,EAAN,EAAX;;AACA,cAAI,KAAI,CAACe,mBAAL,CAAyByC,QAAzB,CAAkCxD,EAAlC,CAAJ,EAA2C;AACvC,iBAAI,CAACe,mBAAL,GAA2B,KAAI,CAACA,mBAAL,CAAyBzC,MAAzB,CAAgC,UAACmF,CAAD;AAAA,qBAAOA,CAAC,IAAIzD,EAAZ;AAAA,aAAhC,CAA3B;AACH,WAFD,MAEO;AACH,iBAAI,CAACe,mBAAL,CAAyBpD,IAAzB,CAA8BqC,EAA9B;AACH;;AAED,eAAI,CAAC+C,YAAL,CAAkB,KAAI,CAAC/D,MAAL,GAAc2D,IAAhC;AACH;AAbL,OADJ,EAgBIW,KAAK,CAACC,UAAN,EAhBJ,CAFJ;AAqBH,KAzBL;;AA2BA,QAAIpF,wDAAG,CAACuF,YAAJ,CAAiBC,GAAjB,CAAqB,gBAArB,KAA0CxF,wDAAG,CAACyE,KAAJ,CAAUC,SAAV,CAAoB,sBAApB,CAA9C,EAA2F;AACvFjB,WAAK,CAACM,GAAN,CACI,SADJ,EAEI7E,yDAAe,CAAC+B,SAAhB,CACI;AACIvB,iBAAS,EAAE,mBADf;AAEID,YAAI,EAAE,YAFV;AAGIF,eAAO,EAAE,KAAKwD,0BAAL,CAAgC,gBAAhC,MAAsD,cAHnE;AAII5B,eAAO,EAAE,mBAAM;AACX,cAAMU,EAAE,GAAG,gBAAX;;AACA,cAAI,KAAI,CAACkB,0BAAL,CAAgClB,EAAhC,MAAwC,cAA5C,EAA4D;AACxD,iBAAI,CAACkB,0BAAL,CAAgClB,EAAhC,IAAsC,EAAtC;AACH,WAFD,MAEO;AACH,iBAAI,CAACkB,0BAAL,CAAgClB,EAAhC,IAAsC,cAAtC;AACH;;AAED,eAAI,CAAC+C,YAAL,CAAkB,KAAI,CAAC/D,MAAL,GAAc2D,IAAhC;AACH;AAbL,OADJ,EAgBIxE,wDAAG,CAACC,UAAJ,CAAeC,KAAf,CAAqB,mDAArB,CAhBJ,CAFJ,EAoBI,EApBJ;AAuBAuD,WAAK,CAACM,GAAN,CAAU,WAAV,EAAuB0B,0EAAS,CAACxE,SAAV,EAAvB,EAA8C,EAA9C;AACH;;AAED,WAAOwC,KAAP;AACH,G;;SAEDD,W,GAAA,uBAAc;AAAA;;AACV,QAAMC,KAAK,GAAG,IAAIU,mEAAJ,EAAd;AAEAV,SAAK,CAACM,GAAN,CACI,SADJ,EAEIpE,sEAAM,CAACsB,SAAP,CAAiB;AACbyE,WAAK,EAAE1F,wDAAG,CAACC,UAAJ,CAAeC,KAAf,CAAqB,+CAArB,CADM;AAEbT,UAAI,EAAE,aAFO;AAGbC,eAAS,EAAE,qBAHE;AAIbyB,aAAO,EAAE,mBAAM;AACX,cAAI,CAACZ,KAAL,CAAWoF,OAAX;;AACA,YAAI3F,wDAAG,CAAC4F,OAAJ,CAAYhE,IAAhB,EAAsB;AAClB5B,kEAAG,CAACiF,KAAJ,CAAUY,IAAV,CAAe,OAAf,EAAwB7F,wDAAG,CAAC4F,OAAJ,CAAYhE,IAAZ,CAAiBC,EAAjB,EAAxB;AACAiE,WAAC,CAACC,MAAF;AACH;AACJ;AAVY,KAAjB,CAFJ;AAgBA,WAAOtC,KAAP;AACH;AAED;AACJ;AACA;AACA;AACA;;;SACImB,Y,GAAA,sBAAaJ,IAAb,EAAmB;AACf,QAAM3D,MAAM,GAAG,KAAKA,MAAL,EAAf;;AAEA,QAAI2D,IAAI,KAAKxE,wDAAG,CAACyE,KAAJ,CAAUC,SAAV,CAAoB,0BAApB,CAAb,EAA8D;AAC1D,aAAO7D,MAAM,CAAC2D,IAAd;AACH,KAFD,MAEO;AACH3D,YAAM,CAAC2D,IAAP,GAAcA,IAAd;AACH;;AAED,QAAIwB,KAAK,GAAG,EAAZ;;AACA,SAAK,IAAI7F,MAAT,IAAmB,KAAK4C,0BAAxB,EAAoD;AAChDiD,WAAK,IAAI,KAAKjD,0BAAL,CAAgC5C,MAAhC,IAA0C,GAAnD;AACH;;AAED,QAAI,KAAKyC,mBAAL,CAAyBqD,MAAzB,GAAkC,CAAtC,EAAyC;AACrCpF,YAAM,CAACH,QAAP,GAAkB;AAAEwF,cAAM,EAAE,WAAW,KAAKtD,mBAAL,CAAyBC,IAAzB,CAA8B,GAA9B;AAArB,OAAlB;AACH,KAFD,MAEO;AACHhC,YAAM,CAACH,QAAP,GAAkB;AAAEwF,cAAM,EAAE,EAAV;AAAc5D,SAAC,EAAE0D,KAAK,CAACG,IAAN;AAAjB,OAAlB;AACH;;AAED,SAAK5F,KAAL,CAAWC,aAAX,CAAyBK,MAAzB;AACH,G;;SAEDiD,Y,GAAA,wBAAe;AACX,WAAO;AACHU,UAAI,EAAEsB,CAAC,CAAC5B,KAAF,CAAQkC,KAAR,CAAc,MAAd,CADH;AAEH9D,OAAC,EAAEwD,CAAC,CAAC5B,KAAF,CAAQkC,KAAR,CAAc,GAAd;AAFA,KAAP;AAIH,G;;SAEDvF,M,GAAA,kBAAS;AACL,WAAO,KAAKiD,YAAL,EAAP;AACH,G;;;EA/P0CuC,oE;;;;;;;;;;;;;;ACnB/C;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;CAGA;;AACA;AAEArG,wDAAG,CAACuF,YAAJ,CAAiBxB,GAAjB,CAAqB,oBAArB,EAA2C,UAAC/D,GAAD,EAAS;AAChDA,KAAG,CAACsG,MAAJ,CAAWC,kBAAX,GAAgC;AAC5BC,QAAI,EAAE,QADsB;AAE5BvF,aAAS,EAAEgB,qEAAiBA;AAFA,GAAhC;AAKAwE,qEAAM,CAACC,iFAAiB,CAACxD,SAAnB,EAA8B,MAA9B,EAAsC,UAAUnD,IAAV,EAAgB4G,KAAhB,EAAuB;AAC/D,QAAI,CAAC5G,IAAL,EAAW;AACP;AACH;;AAED4G,SAAK,GAAGA,KAAK,CAACC,WAAN,EAAR;AAEA7G,QAAI,CAAC8G,MAAL,CACI,CADJ,EAEI,CAFJ,EAGIf,CAAC,CACG,IADH,EAEG9B,0EAAU,CAAC/C,SAAX,CACI;AACIgD,UAAI,EAAEjE,GAAG,CAACkE,KAAJ,CAAU,oBAAV,EAAgC;AAAE5B,SAAC,EAAEqE;AAAL,OAAhC,CADV;AAEIlH,UAAI,EAAE;AAFV,KADJ,EAKIO,GAAG,CAACC,UAAJ,CAAeC,KAAf,CAAqB,+CAArB,EAAsE;AAAEyG,WAAK,EAALA;AAAF,KAAtE,CALJ,CAFH,CAHL;AAcH,GArBK,CAAN;AAuBAF,qEAAM,CAACxD,yEAAS,CAACC,SAAX,EAAsB,UAAtB,EAAkC,UAACO,KAAD,EAAW;AAC/C,QAAIzD,GAAG,CAACyE,KAAJ,CAAUC,SAAV,CAAoB,yBAApB,CAAJ,EAAoD;AAChDjB,WAAK,CAACM,GAAN,CACI,oBADJ,EAEIC,0EAAU,CAAC/C,SAAX,CACI;AACIgD,YAAI,EAAEjE,GAAG,CAACkE,KAAJ,CAAU,oBAAV,CADV;AAEIzE,YAAI,EAAE;AAFV,OADJ,EAKIO,GAAG,CAACC,UAAJ,CAAeC,KAAf,CAAqB,mCAArB,CALJ,CAFJ,EASI,EATJ;AAWH;AACJ,GAdK,CAAN;AAeH,CA5CD,E;;;;;;;;;;;;;;;;;;ACfA;AACA;AACA;AACA;;IAEqBgC,kB;AACjB,8BAAYrB,MAAZ,EAAyBb,GAAzB,EAA2C;AAAA,QAA/Ba,MAA+B;AAA/BA,YAA+B,GAAtB,EAAsB;AAAA;;AAAA,QAAlBb,GAAkB;AAAlBA,SAAkB,GAAZ8G,MAAM,CAAC9G,GAAK;AAAA;;AACvC,SAAKa,MAAL,GAAcA,MAAd;AAEA,SAAKb,GAAL,GAAWA,GAAX;AAEA,SAAK0B,KAAL,GAAa,EAAb;AAEA,SAAKR,WAAL,GAAmB,KAAnB;AAEA,SAAKJ,OAAL,GAAe,KAAf;AAEA,SAAKJ,QAAL,GAAgB,EAAhB;AACH;;;;SAEDqG,a,GAAA,yBAAgB;AACZ,QAAMlG,MAAM,GAAG;AAAEmG,aAAO,EAAE,EAAX;AAAe7G,YAAM,EAAE;AAAvB,KAAf;AAEA,QAAM8G,OAAO,GAAG,KAAKpG,MAAL,CAAY2D,IAAZ,IAAoBxE,GAAG,CAACyE,KAAJ,CAAUC,SAAV,CAAoB,0BAApB,CAApC,CAHY,CAKZ;;AACA7D,UAAM,CAAC2D,IAAP,GAAc,KAAK7F,OAAL,GAAesI,OAAf,CAAd;;AAEA,QAAI,KAAKpG,MAAL,CAAYyB,CAAhB,EAAmB;AACfzB,YAAM,CAACV,MAAP,CAAcmC,CAAd,GAAkB,KAAKzB,MAAL,CAAYyB,CAA9B;AACH;;AAED,WAAOzB,MAAP;AACH,G;;SAEDlC,O,GAAA,mBAAU;AACN;AACI,iBAAS;AADb,OAEO,IAAID,6DAAJ,GAAcC,OAAd,EAFP;AAIH,G;;SAED8B,S,GAAA,qBAAY;AACR,WAAO,KAAKI,MAAZ;AACH,G;;SAEDqG,K,GAAA,iBAAQ;AACJ,SAAKxF,KAAL,GAAa,EAAb;AACAoE,KAAC,CAACC,MAAF;AACH,G;;SAEDvF,a,GAAA,uBAAc2G,SAAd,EAAyB;AAAA;;AACrB,QAAI,CAAC,KAAKC,QAAL,EAAD,IAAoBC,MAAM,CAACC,IAAP,CAAYH,SAAZ,EAAuBI,IAAvB,CAA4B,UAACC,GAAD;AAAA,aAAS,KAAI,CAAC/G,SAAL,GAAiB+G,GAAjB,MAA0BL,SAAS,CAACK,GAAD,CAA5C;AAAA,KAA5B,CAAxB,EAAwG;AACpG,WAAK3G,MAAL,GAAcsG,SAAd;;AACA,yFAAc,KAAKzG,QAAnB,EAA6ByG,SAAS,CAACzG,QAAV,IAAsB,EAAnD;;AACA,WAAKG,MAAL,CAAYyB,CAAZ,GAAgB+E,MAAM,CAACI,MAAP,CAAc,KAAK/G,QAAnB,EAA6BmC,IAA7B,CAAkC,GAAlC,EAAuCsD,IAAvC,EAAhB;AACA,WAAKR,OAAL;AACH;AACJ,G;;SAEDA,O,GAAA,mBAAU;AAAA;;AACN,SAAK7E,OAAL,GAAe,IAAf;AAEA,SAAKoG,KAAL;AAEA,WAAO,KAAKQ,WAAL,GAAmBC,IAAnB,CACH,UAACC,OAAD,EAAa;AACT,YAAI,CAAClG,KAAL,GAAa,EAAb;;AACA,YAAI,CAACmG,YAAL,CAAkBD,OAAlB;AACH,KAJE,EAKH,YAAM;AACF,YAAI,CAAC9G,OAAL,GAAe,KAAf;AACAgF,OAAC,CAACC,MAAF;AACH,KARE,CAAP;AAUH,G;;SAED2B,W,GAAA,qBAAYI,MAAZ,EAAoB;AAChB,QAAMC,cAAc,GAAG,KAAK/H,GAAL,CAASgI,oBAAT,EAAvB;;AAEA,QAAID,cAAJ,EAAoB;AAChB,aAAOE,OAAO,CAACC,OAAR,CAAgBH,cAAhB,CAAP;AACH;;AAED,QAAMlH,MAAM,GAAG,KAAKkG,aAAL,EAAf;AACAlG,UAAM,CAACsH,IAAP,GAAc;AAAEL,YAAM,EAANA;AAAF,KAAd;AACAjH,UAAM,CAACmG,OAAP,GAAiBnG,MAAM,CAACmG,OAAP,CAAenE,IAAf,CAAoB,GAApB,CAAjB;AAEA,WAAO,KAAK7C,GAAL,CAASiF,KAAT,CAAeY,IAAf,CAAoB,OAApB,EAA6BhF,MAA7B,CAAP;AACH,G;;SAEDO,Q,GAAA,oBAAW;AACP,SAAKN,OAAL,GAAe,IAAf;AAEA,SAAK4G,WAAL,CAAiB,KAAKhG,KAAL,CAAWuE,MAA5B,EAAoC0B,IAApC,CAAyC,KAAKE,YAAL,CAAkBxG,IAAlB,CAAuB,IAAvB,CAAzC;AACH,G;;SAEDwG,Y,GAAA,sBAAaD,OAAb,EAAsB;AAAA;;AAClB,wBAAKlG,KAAL,EAAWlC,IAAX,oBAAmBoI,OAAnB;;AAEA,SAAK9G,OAAL,GAAe,KAAf;AACA,SAAKI,WAAL,GAAmB,CAAC,CAAC0G,OAAO,CAACQ,OAAR,CAAgBC,KAAlB,IAA2B,CAAC,CAACT,OAAO,CAACQ,OAAR,CAAgBC,KAAhB,CAAsBC,IAAtE;AAEAxC,KAAC,CAACC,MAAF;AAEA,WAAO6B,OAAP;AACH,G;;SAEDR,Q,GAAA,oBAAW;AACP,WAAO,KAAK1F,KAAL,CAAWuE,MAAX,GAAoB,CAA3B;AACH,G;;SAEDlF,S,GAAA,qBAAY;AACR,WAAO,KAAKD,OAAZ;AACH,G;;SAEDW,e,GAAA,2BAAkB;AACd,WAAO,CAAC,CAAC,KAAKZ,MAAL,CAAYyB,CAArB;AACH,G;;SAEDhB,K,GAAA,iBAAQ;AACJ,WAAO,CAAC,KAAK8F,QAAL,EAAD,IAAoB,CAAC,KAAKrG,SAAL,EAA5B;AACH,G;;;;;;;;;;;;;;;;AC1HL,wD;;;;;;;;;;;ACAA,kD;;;;;;;;;;;ACAA,gE;;;;;;;;;;;ACAA,kE;;;;;;;;;;;ACAA,mE;;;;;;;;;;;ACAA,oE;;;;;;;;;;;ACAA,0E;;;;;;;;;;;ACAA,8D;;;;;;;;;;;ACAA,qE;;;;;;;;;;;ACAA,gE;;;;;;;;;;;ACAA,wE;;;;;;;;;;;ACAA,mE;;;;;;;;;;;ACAA,kE;;;;;;;;;;;ACAA,2E;;;;;;;;;;;ACAA,qD;;;;;;;;;;;ACAA,2D;;;;;;;;;;;ACAA,gE;;;;;;;;;;;ACAA,6D;;;;;;;;;;;ACAA,6D","file":"forum.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./forum.js\");\n","export * from './src/forum';\r\n","export default function _extends() {\n  _extends = Object.assign || function (target) {\n    for (var i = 1; i < arguments.length; i++) {\n      var source = arguments[i];\n\n      for (var key in source) {\n        if (Object.prototype.hasOwnProperty.call(source, key)) {\n          target[key] = source[key];\n        }\n      }\n    }\n\n    return target;\n  };\n\n  return _extends.apply(this, arguments);\n}","export default function _inheritsLoose(subClass, superClass) {\n  subClass.prototype = Object.create(superClass.prototype);\n  subClass.prototype.constructor = subClass;\n  subClass.__proto__ = superClass;\n}","/**\n * The sort options.\n * We use a class and not just a POJO/function because we want extensions to be able to extend it\n */\nexport default class SortMap {\n    sortMap() {\n        return {\n            username_az: 'username',\n            username_za: '-username',\n            newest: '-joinedAt',\n            oldest: 'joinedAt',\n            most_discussions: '-discussionCount',\n            least_discussions: 'discussionCount',\n        };\n    }\n}\n","import Button from 'flarum/common/components/Button';\r\nimport icon from 'flarum/common/helpers/icon';\r\n\r\nexport default class CheckableButton extends Button {\r\n    /**\r\n     * Get the template for the button's content.\r\n     *\r\n     * @return {*}\r\n     * @protected\r\n     */\r\n    getButtonContent(children) {\r\n        const prev = super.getButtonContent(children);\r\n\r\n        if (this.attrs.checked) prev.push(icon('fas fa-check', { className: 'Button-icon ButtonCheck' }));\r\n\r\n        return prev;\r\n    }\r\n}\r\n","import app from 'flarum/common/app';\r\nimport Component from 'flarum/common/Component';\r\nimport withAttr from 'flarum/common/utils/withAttr';\r\n\r\nexport default class SearchField extends Component {\r\n    oninit(vnode) {\r\n        super.oninit(vnode);\r\n    }\r\n\r\n    view() {\r\n        return (\r\n            <div className=\"Form-group Usersearchbox\">\r\n                <input\r\n                    className=\"FormControl\"\r\n                    placeholder={app.translator.trans('fof-user-directory.forum.search.field.placeholder')}\r\n                    value={this.filter}\r\n                    oninput={withAttr('value', (value) => {\r\n                        this.filter = value;\r\n                        this.performNewSearch();\r\n                    })}\r\n                />\r\n            </div>\r\n        );\r\n    }\r\n\r\n    performNewSearch() {\r\n        this.attrs.state.refreshParams({ ...this.attrs.state.getParams(), qBuilder: { filter: this.filter } });\r\n    }\r\n}\r\n","import app from 'flarum/common/app';\r\nimport Component from 'flarum/common/Component';\r\nimport Button from 'flarum/common/components/Button';\r\nimport LoadingIndicator from 'flarum/common/components/LoadingIndicator';\r\nimport Placeholder from 'flarum/common/components/Placeholder';\r\nimport UserDirectoryListItem from './UserDirectoryListItem';\r\n\r\n/**\r\n * Based on Flarum's DiscussionList\r\n */\r\nexport default class UserDirectoryList extends Component {\r\n    view() {\r\n        const { state } = this.attrs;\r\n\r\n        const params = state.getParams();\r\n        let loading;\r\n\r\n        if (state.isLoading()) {\r\n            loading = LoadingIndicator.component();\r\n        } else if (state.moreResults) {\r\n            loading = Button.component(\r\n                {\r\n                    className: 'Button',\r\n                    onclick: state.loadMore.bind(state),\r\n                },\r\n                app.translator.trans('fof-user-directory.forum.page.load_more_button')\r\n            );\r\n        }\r\n\r\n        if (state.empty()) {\r\n            const text = app.translator.trans('fof-user-directory.forum.page.empty_text');\r\n            return <div className=\"DiscussionList\">{Placeholder.component({ text })}</div>;\r\n        }\r\n\r\n        return (\r\n            <div className={'UserDirectoryList' + (state.isSearchResults() ? ' UserDirectoryList--searchResults' : '')}>\r\n                <ul className=\"UserDirectoryList-users\">\r\n                    {state.users.map((user) => {\r\n                        return (\r\n                            <li key={user.id()} data-id={user.id()}>\r\n                                {UserDirectoryListItem.component({ user, params })}\r\n                            </li>\r\n                        );\r\n                    })}\r\n                </ul>\r\n                <div className=\"UserDirectoryList-loadMore\">{loading}</div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import Component from 'flarum/common/Component';\r\nimport UserCard from 'flarum/common/components/UserCard';\r\n\r\nexport default class UserDirectoryListItem extends Component {\r\n    view() {\r\n        const { user } = this.attrs;\r\n\r\n        return (\r\n            <div className=\"User\">\r\n                {UserCard.component({\r\n                    user,\r\n                    className: 'UserCard--directory',\r\n                    controlsButtonClassName: 'Button Button--icon Button--flat',\r\n                })}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n","import app from 'flarum/common/app';\r\nimport Page from 'flarum/common/components/Page';\r\nimport ItemList from 'flarum/common/utils/ItemList';\r\nimport listItems from 'flarum/common/helpers/listItems';\r\nimport IndexPage from 'flarum/common/components/IndexPage';\r\nimport Select from 'flarum/common/components/Select';\r\nimport Button from 'flarum/common/components/Button';\r\nimport LinkButton from 'flarum/common/components/LinkButton';\r\nimport SelectDropdown from 'flarum/common/components/SelectDropdown';\r\nimport Dropdown from 'flarum/common/components/Dropdown';\r\nimport UserDirectoryList from './UserDirectoryList';\r\nimport UserDirectoryState from '../states/UserDirectoryState';\r\nimport CheckableButton from './CheckableButton';\r\nimport SearchField from './SearchField';\r\nimport Separator from 'flarum/common/components/Separator';\r\n\r\n/**\r\n * This page re-uses Flarum's IndexPage CSS classes\r\n */\r\nexport default class UserDirectoryPage extends Page {\r\n    oninit(vnode) {\r\n        super.oninit(vnode);\r\n\r\n        this.state = new UserDirectoryState({});\r\n        this.state.refreshParams(app.search.params());\r\n\r\n        this.bodyClass = 'User--directory';\r\n\r\n        let idSegments = [];\r\n        if (this.params().q) {\r\n            Array.from(this.params().q.matchAll(/group:([\\d,]+)/g)).forEach((match) => {\r\n                idSegments.push(match[1]);\r\n            });\r\n        }\r\n        this.enabledGroupFilters = idSegments\r\n            .join(',')\r\n            .split(',')\r\n            .filter((id) => id);\r\n\r\n        this.enabledSpecialGroupFilters = [];\r\n\r\n        app.history.push('users', app.translator.trans('fof-user-directory.forum.header.back_to_user_directory_tooltip'));\r\n    }\r\n\r\n    view() {\r\n        return (\r\n            <div className=\"IndexPage\">\r\n                {IndexPage.prototype.hero()}\r\n                <div className=\"container\">\r\n                    <div className=\"sideNavContainer\">\r\n                        <nav className=\"IndexPage-nav sideNav\">\r\n                            <ul>{listItems(this.sidebarItems().toArray())}</ul>\r\n                        </nav>\r\n                        <div className=\"IndexPage-results sideNavOffset\">\r\n                            <div className=\"IndexPage-toolbar\">\r\n                                <ul className=\"IndexPage-toolbar-view\">{listItems(this.viewItems().toArray())}</ul>\r\n                                <ul className=\"IndexPage-toolbar-action\">{listItems(this.actionItems().toArray())}</ul>\r\n                            </div>\r\n                            <UserDirectoryList state={this.state} />\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    /**\r\n     * Our own sidebar. Re-uses Index.sidebarItems as the base\r\n     * Elements added here will only show up on the user directory page\r\n     *\r\n     * @return {ItemList}\r\n     */\r\n    sidebarItems() {\r\n        const items = IndexPage.prototype.sidebarItems();\r\n\r\n        items.replace(\r\n            'nav',\r\n            SelectDropdown.component(\r\n                {\r\n                    buttonClassName: 'Button',\r\n                    className: 'App-titleControl',\r\n                },\r\n                this.navItems().toArray()\r\n            )\r\n        );\r\n\r\n        return items;\r\n    }\r\n\r\n    /**\r\n     * Our own sidebar navigation. Re-uses Index.navItems as the base\r\n     * Elements added here will only show up on the user directory page\r\n     *\r\n     * @return {ItemList}\r\n     */\r\n    navItems() {\r\n        const items = IndexPage.prototype.navItems();\r\n        const params = this.stickyParams();\r\n\r\n        items.add(\r\n            'fof-user-directory',\r\n            LinkButton.component(\r\n                {\r\n                    href: app.route('fof_user_directory', params),\r\n                    icon: 'far fa-address-book',\r\n                },\r\n                app.translator.trans('fof-user-directory.forum.page.nav')\r\n            ),\r\n            85\r\n        );\r\n\r\n        return items;\r\n    }\r\n\r\n    viewItems() {\r\n        const items = new ItemList();\r\n        const sortMap = this.state.sortMap();\r\n\r\n        const sortOptions = {};\r\n        for (const i in sortMap) {\r\n            sortOptions[i] = app.translator.trans('fof-user-directory.lib.sort.' + i);\r\n        }\r\n\r\n        items.add(\r\n            'sort',\r\n            Select.component({\r\n                options: sortOptions,\r\n                value: this.params().sort || app.forum.attribute('userDirectoryDefaultSort'),\r\n                onchange: this.changeParams.bind(this),\r\n            })\r\n        );\r\n\r\n        items.add(\r\n            'filterGroups',\r\n            Dropdown.component(\r\n                {\r\n                    caretIcon: 'fas fa-filter',\r\n                    label: app.translator.trans('fof-user-directory.forum.page.filter_button'),\r\n                    buttonClassName: 'FormControl',\r\n                    className: 'GroupFilterDropdown',\r\n                },\r\n                this.groupItems().toArray()\r\n            )\r\n        );\r\n\r\n        items.add(\r\n            'search',\r\n            SearchField.component({\r\n                state: this.state,\r\n            })\r\n        );\r\n\r\n        return items;\r\n    }\r\n\r\n    groupItems() {\r\n        const items = new ItemList();\r\n\r\n        app.store\r\n            .all('groups')\r\n            .filter((group) => group.id() !== '2' && group.id() !== '3')\r\n            .forEach((group) => {\r\n                items.add(\r\n                    group.namePlural(),\r\n                    CheckableButton.component(\r\n                        {\r\n                            className: 'GroupFilterButton',\r\n                            icon: group.icon(),\r\n                            checked: this.enabledGroupFilters.includes(group.id()),\r\n                            onclick: () => {\r\n                                const id = group.id();\r\n                                if (this.enabledGroupFilters.includes(id)) {\r\n                                    this.enabledGroupFilters = this.enabledGroupFilters.filter((e) => e != id);\r\n                                } else {\r\n                                    this.enabledGroupFilters.push(id);\r\n                                }\r\n\r\n                                this.changeParams(this.params().sort);\r\n                            },\r\n                        },\r\n                        group.namePlural()\r\n                    )\r\n                );\r\n            });\r\n\r\n        if (app.initializers.has('flarum-suspend') && app.forum.attribute('hasSuspendPermission')) {\r\n            items.add(\r\n                'suspend',\r\n                CheckableButton.component(\r\n                    {\r\n                        className: 'GroupFilterButton',\r\n                        icon: 'fas fa-ban',\r\n                        checked: this.enabledSpecialGroupFilters['flarum-suspend'] === 'is:suspended',\r\n                        onclick: () => {\r\n                            const id = 'flarum-suspend';\r\n                            if (this.enabledSpecialGroupFilters[id] === 'is:suspended') {\r\n                                this.enabledSpecialGroupFilters[id] = '';\r\n                            } else {\r\n                                this.enabledSpecialGroupFilters[id] = 'is:suspended';\r\n                            }\r\n\r\n                            this.changeParams(this.params().sort);\r\n                        },\r\n                    },\r\n                    app.translator.trans('flarum-suspend.forum.user_badge.suspended_tooltip')\r\n                ),\r\n                90\r\n            );\r\n\r\n            items.add('seperator', Separator.component(), 50);\r\n        }\r\n\r\n        return items;\r\n    }\r\n\r\n    actionItems() {\r\n        const items = new ItemList();\r\n\r\n        items.add(\r\n            'refresh',\r\n            Button.component({\r\n                title: app.translator.trans('fof-user-directory.forum.page.refresh_tooltip'),\r\n                icon: 'fas fa-sync',\r\n                className: 'Button Button--icon',\r\n                onclick: () => {\r\n                    this.state.refresh();\r\n                    if (app.session.user) {\r\n                        app.store.find('users', app.session.user.id());\r\n                        m.redraw();\r\n                    }\r\n                },\r\n            })\r\n        );\r\n\r\n        return items;\r\n    }\r\n\r\n    /**\r\n     * Redirect to the index page using the given sort parameter.\r\n     *\r\n     * @param {String} sort\r\n     */\r\n    changeParams(sort) {\r\n        const params = this.params();\r\n\r\n        if (sort === app.forum.attribute('userDirectoryDefaultSort')) {\r\n            delete params.sort;\r\n        } else {\r\n            params.sort = sort;\r\n        }\r\n\r\n        let moreQ = '';\r\n        for (var filter in this.enabledSpecialGroupFilters) {\r\n            moreQ += this.enabledSpecialGroupFilters[filter] + ' ';\r\n        }\r\n\r\n        if (this.enabledGroupFilters.length > 0) {\r\n            params.qBuilder = { groups: 'group:' + this.enabledGroupFilters.join(',') };\r\n        } else {\r\n            params.qBuilder = { groups: '', q: moreQ.trim() };\r\n        }\r\n\r\n        this.state.refreshParams(params);\r\n    }\r\n\r\n    stickyParams() {\r\n        return {\r\n            sort: m.route.param('sort'),\r\n            q: m.route.param('q'),\r\n        };\r\n    }\r\n\r\n    params() {\r\n        return this.stickyParams();\r\n    }\r\n}\r\n","import { extend } from 'flarum/common/extend';\r\nimport app from 'flarum/common/app';\r\nimport UsersSearchSource from 'flarum/common/components/UsersSearchSource';\r\nimport LinkButton from 'flarum/common/components/LinkButton';\r\nimport IndexPage from 'flarum/common/components/IndexPage';\r\nimport UserDirectoryPage from './components/UserDirectoryPage';\r\nimport UserDirectoryList from './components/UserDirectoryList';\r\nimport UserDirectoryListItem from './components/UserDirectoryListItem';\r\nimport UserDirectoryState from './states/UserDirectoryState';\r\nimport SortMap from '../common/utils/SortMap';\r\nimport CheckableButton from './components/CheckableButton';\r\n\r\n// Allow other extensions to extend the page\r\nexport { UserDirectoryPage, UserDirectoryList, UserDirectoryListItem, UserDirectoryState, SortMap, CheckableButton };\r\n\r\napp.initializers.add('fof-user-directory', (app) => {\r\n    app.routes.fof_user_directory = {\r\n        path: '/users',\r\n        component: UserDirectoryPage,\r\n    };\r\n\r\n    extend(UsersSearchSource.prototype, 'view', function (view, query) {\r\n        if (!view) {\r\n            return;\r\n        }\r\n\r\n        query = query.toLowerCase();\r\n\r\n        view.splice(\r\n            1,\r\n            0,\r\n            m(\r\n                'li',\r\n                LinkButton.component(\r\n                    {\r\n                        href: app.route('fof_user_directory', { q: query }),\r\n                        icon: 'fas fa-search',\r\n                    },\r\n                    app.translator.trans('fof-user-directory.forum.search.users_heading', { query })\r\n                )\r\n            )\r\n        );\r\n    });\r\n\r\n    extend(IndexPage.prototype, 'navItems', (items) => {\r\n        if (app.forum.attribute('canSeeUserDirectoryLink')) {\r\n            items.add(\r\n                'fof-user-directory',\r\n                LinkButton.component(\r\n                    {\r\n                        href: app.route('fof_user_directory'),\r\n                        icon: 'far fa-address-book',\r\n                    },\r\n                    app.translator.trans('fof-user-directory.forum.page.nav')\r\n                ),\r\n                85\r\n            );\r\n        }\r\n    });\r\n});\r\n","/**\r\n * Based on Flarum's DiscussionListState\r\n */\r\nimport SortMap from '../../common/utils/SortMap';\r\n\r\nexport default class UserDirectoryState {\r\n    constructor(params = {}, app = window.app) {\r\n        this.params = params;\r\n\r\n        this.app = app;\r\n\r\n        this.users = [];\r\n\r\n        this.moreResults = false;\r\n\r\n        this.loading = false;\r\n\r\n        this.qBuilder = {};\r\n    }\r\n\r\n    requestParams() {\r\n        const params = { include: [], filter: {} };\r\n\r\n        const sortKey = this.params.sort || app.forum.attribute('userDirectoryDefaultSort');\r\n\r\n        // sort might be set to null if no sort params has been passed\r\n        params.sort = this.sortMap()[sortKey];\r\n\r\n        if (this.params.q) {\r\n            params.filter.q = this.params.q;\r\n        }\r\n\r\n        return params;\r\n    }\r\n\r\n    sortMap() {\r\n        return {\r\n            default: '',\r\n            ...new SortMap().sortMap(),\r\n        };\r\n    }\r\n\r\n    getParams() {\r\n        return this.params;\r\n    }\r\n\r\n    clear() {\r\n        this.users = [];\r\n        m.redraw();\r\n    }\r\n\r\n    refreshParams(newParams) {\r\n        if (!this.hasUsers() || Object.keys(newParams).some((key) => this.getParams()[key] !== newParams[key])) {\r\n            this.params = newParams;\r\n            Object.assign(this.qBuilder, newParams.qBuilder || {});\r\n            this.params.q = Object.values(this.qBuilder).join(' ').trim();\r\n            this.refresh();\r\n        }\r\n    }\r\n\r\n    refresh() {\r\n        this.loading = true;\r\n\r\n        this.clear();\r\n\r\n        return this.loadResults().then(\r\n            (results) => {\r\n                this.users = [];\r\n                this.parseResults(results);\r\n            },\r\n            () => {\r\n                this.loading = false;\r\n                m.redraw();\r\n            }\r\n        );\r\n    }\r\n\r\n    loadResults(offset) {\r\n        const preloadedUsers = this.app.preloadedApiDocument();\r\n\r\n        if (preloadedUsers) {\r\n            return Promise.resolve(preloadedUsers);\r\n        }\r\n\r\n        const params = this.requestParams();\r\n        params.page = { offset };\r\n        params.include = params.include.join(',');\r\n\r\n        return this.app.store.find('users', params);\r\n    }\r\n\r\n    loadMore() {\r\n        this.loading = true;\r\n\r\n        this.loadResults(this.users.length).then(this.parseResults.bind(this));\r\n    }\r\n\r\n    parseResults(results) {\r\n        this.users.push(...results);\r\n\r\n        this.loading = false;\r\n        this.moreResults = !!results.payload.links && !!results.payload.links.next;\r\n\r\n        m.redraw();\r\n\r\n        return results;\r\n    }\r\n\r\n    hasUsers() {\r\n        return this.users.length > 0;\r\n    }\r\n\r\n    isLoading() {\r\n        return this.loading;\r\n    }\r\n\r\n    isSearchResults() {\r\n        return !!this.params.q;\r\n    }\r\n\r\n    empty() {\r\n        return !this.hasUsers() && !this.isLoading();\r\n    }\r\n}\r\n","module.exports = flarum.core.compat['common/Component'];","module.exports = flarum.core.compat['common/app'];","module.exports = flarum.core.compat['common/components/Button'];","module.exports = flarum.core.compat['common/components/Dropdown'];","module.exports = flarum.core.compat['common/components/IndexPage'];","module.exports = flarum.core.compat['common/components/LinkButton'];","module.exports = flarum.core.compat['common/components/LoadingIndicator'];","module.exports = flarum.core.compat['common/components/Page'];","module.exports = flarum.core.compat['common/components/Placeholder'];","module.exports = flarum.core.compat['common/components/Select'];","module.exports = flarum.core.compat['common/components/SelectDropdown'];","module.exports = flarum.core.compat['common/components/Separator'];","module.exports = flarum.core.compat['common/components/UserCard'];","module.exports = flarum.core.compat['common/components/UsersSearchSource'];","module.exports = flarum.core.compat['common/extend'];","module.exports = flarum.core.compat['common/helpers/icon'];","module.exports = flarum.core.compat['common/helpers/listItems'];","module.exports = flarum.core.compat['common/utils/ItemList'];","module.exports = flarum.core.compat['common/utils/withAttr'];"],"sourceRoot":""}